<nl-dlg title='{{data.pagetitle}}' show-help='0'>
<nl-dlg-content>
<style>
    .video_preview {
        width: 100%;
        height: 360px;
    }
</style>
<div>
    <nl-dlg-row attr='source' data='data' help='help'
                ng-show='markupInfo.insertOrUpdateResource'>                
        <nl-select fieldmodel='source'></nl-select>
    </nl-dlg-row> 

    <nl-dlg-row attr='restype' data='data' help='help'
                ng-show='!markupInfo.restypeInfo'>
        <nl-select ng-if='data.card == null' fieldmodel='restype'></nl-select>
        <input ng-if='data.card !== null' ng-model='data.restype.id' readonly class='nl-dlg-field-value'></input>
    </nl-dlg-row> 

    <nl-dlg-row attr='url' data='data' help='help'
                ng-show='data.source.id == "url"'>
        <nl-input fieldmodel='url' fieldtype='text' fieldcls='w100'></nl-input>
    </nl-dlg-row> 

    <nl-dlg-row attr='resource' data='data' help='help'
                ng-show='data.source.id == "upload"'>
        <nl-resource-upload 
            ng-repeat='restype in options.restype'
            ng-if='restype.id == data.restype.id'
            fieldmodel='resource' 
            restype='{{restype.id}}'>
        </nl-resource-upload>
    </nl-dlg-row> 

    <nl-dlg-row attr='recordingName' data='data' help='help'
                ng-show='data.source.id == "record"'>
        <nl-input fieldmodel='recordingName' fieldtype='text' fieldcls='w100'></nl-input>
    </nl-dlg-row> 

    <nl-dlg-row ng-show='data.source.id == "record"' class='text-center'>
        <div class="button padding-small"
             ng-click='recorder.toggle(data)'>

            <i ng-show='recorder.state == "pending" && data.restype.id == "Video"'
               class='ion-videocamera fsh2 padding-small'></i>
            <i ng-show='recorder.state == "pending" && data.restype.id == "Audio"'
               class='ion-mic-a fsh2 padding-small'></i>
            <span ng-show='recorder.state == "pending"'
                  class='padding-small'>Record</span>

            <i ng-show='recorder.state == "recording"'
                    class='anim_blink forange ion-android-radio-button-on fsh2 padding-small'></i>
            <span ng-show='recorder.state == "recording"'
                  class='padding-small'>Stop</span>

            <i ng-show='recorder.state == "done"'
                    class='ion-ios-refresh fsh2 padding-small'></i>
            <span ng-show='recorder.state == "done"'
                  class='padding-small'>Rerecord</span>
        </div>
        <div class='padding-small'>{{recorder.statusMsg}}</div>
        <div class='padding-mid'>
            <video id='res_add_dlg_recorder_preview'
                   class='video_preview' autoplay muted
                   ng-show='recorder.state != "done"'>
            </video>
            <video id='res_add_dlg_recorder_preview2'
                   class='video_preview' controls
                   ng-show='recorder.state == "done"'>
            </video>
        </div>
        <div ng-show='recorder.state == "done" && recorder.recordedUrl'
             class='fsmall2'>
             <a id='res_add_dlg_recorder_download' 
                ng-href='{{recorder.recordedUrl}}'
                download='{{recorder.getRecordedFileName(data)}}'>
                <i class='icon ion-arrow-down-a padding-small'></i><span>Download</span></a>
        </div>
    </nl-dlg-row> 

    <nl-dlg-row attr='keywords' data='data' help='help'
                ng-show='data.source.id == "upload"'>
        <nl-input fieldmodel='keywords' fieldtype='text' fieldcls='w100'></nl-input>
    </nl-dlg-row> 

    <nl-dlg-row attr='compressionlevel' data='data' help='help'
                ng-show='data.source.id == "upload" && data.restype.id == "Image"'>
        <nl-select fieldmodel='compressionlevel'></nl-select>
    </nl-dlg-row> 

    <nl-dlg-row attr='markupCover' data='data' help='help'
                ng-show='markupInfo.showMarkupOptions && data.restype.id == "Image"'>
        <nl-select fieldmodel='markupCover'></nl-select>
    </nl-dlg-row> 

    <nl-dlg-row attr='markupLink' data='data' help='help'
                ng-show='markupInfo.showMarkupOptions && data.restype.id == "Image"'>
        <nl-input fieldmodel='markupLink' fieldtype='text' fieldcls='w100'></nl-input>
    </nl-dlg-row> 

    <nl-dlg-row attr='markupText' data='data' help='help'
                ng-show='markupInfo.showMarkupOptions && data.restype.id == "Attachment"'>
        <nl-input fieldmodel='markupText' fieldtype='text' fieldcls='w100'></nl-input>
    </nl-dlg-row> 

    <nl-dlg-row attr='markupPopup' data='data' help='help'
                ng-show='markupInfo.showMarkupOptions && (data.restype.id == "Image" && data.markupLink || data.restype.id == "Attachment")'>
        <nl-checkbox fieldmodel='markupPopup' 
                     fieldname='Open link a new window'
                     fieldcls= 'padding-mid'
                     tabindex="0">
        </nl-checkbox>
    </nl-dlg-row> 

    <nl-dlg-row attr='markupPage' data='data' help='help'
                ng-show='markupInfo.showMarkupOptions && data.restype.id == "PDF"'>
        <nl-input fieldmodel='markupPage' fieldtype='number' fieldminvalue=1 fieldcls='w100'></nl-input>
    </nl-dlg-row> 

    <nl-dlg-row attr='markupScale' data='data' help='help'
                ng-show='markupInfo.showMarkupOptions && data.restype.id == "PDF"'>
        <nl-input fieldmodel='markupScale' fieldtype='text' fieldcls='w100'></nl-input>
    </nl-dlg-row> 

    <nl-dlg-row attr='markupStart' data='data' help='help'
         ng-show='markupInfo.showMarkupOptions && (data.restype.id == "Video" || data.restype.id == "Audio")'>
        <nl-input fieldmodel='markupStart' fieldtype='number' fieldminvalue=0 fieldcls='w100'></nl-input>
    </nl-dlg-row> 

    <nl-dlg-row attr='markupEnd' data='data' help='help'
                ng-show='markupInfo.showMarkupOptions && (data.restype.id == "Video" || data.restype.id == "Audio")'>
        <nl-input fieldmodel='markupEnd' fieldtype='number' fieldminvalue=0 fieldcls='w100'></nl-input>
    </nl-dlg-row> 
</div>
</nl-dlg-content>
</nl-dlg>