<div ng-if='selectedModule.lockedOnItem' class='fsh6'>
    You can mark attendance for this session only after all earlier items are completed.
    Please update <b>{{getItemName(selectedModule.lockedOnItem)}}</b> first.
</div>

<div ng-if='!selectedModule.lockedOnItem' style='width:fit-content'>
	<div class='row row-center padding0 margin0'>
		<div class='col padding0'></div>
	
		<div ng-if='isEtmAsd && selectedModule.id == firstSessionId'
			 class='nl-link-text nl-button-lowlight padding-small'
			 ng-click='addAsdSession($event, null)'>Add session above</div>
		<div ng-if='isEtmAsd && selectedModule.id == firstSessionId' class='padding-small'></div>
	
		<div ng-if='isEtmAsd && selectedModule.asdSession'
			 class='nl-link-text nl-button-lowlight padding-small'
			 ng-click='removeAsdSession($event, selectedModule)'>Remove session</div>
		<div ng-if='isEtmAsd && selectedModule.asdSession' class='padding-small'></div>
	
		<div ng-if='isEtmAsd'
			 class='nl-link-text nl-button-highlight padding-small'
			 ng-click='addAsdSession($event, selectedModule)'>Add session</div>
		<div ng-if='isEtmAsd' class='padding-small'></div>		
		<div ng-if='selectedModule.canShowAutoFillButton' class='nl-link-text nl-button-highlight' ng-click='onAutoFillAttendance(selectedModule)'>Autofill</div>	
		<div ng-if='selectedModule.canShowAutoFillButton' class='padding-small'></div>
		<div class='nl-link-text nl-button-highlight' ng-click='showBulkAttendanceMarker($event)'>Mark all</div>
	</div>

	<div ng-if='selectedModule.validationErrorMsg' class='row row-center padding0 margin0'>
		<div class='col padding0'></div>
		<div class='nl-dlg-field-errormsg'> 
			{{selectedModule.dateValidationError}}
		</div>
		<div style='width:102px'></div>
	</div>

	<div ng-if='selectedModule.asdSession' class="padding-small"></div>
	<div ng-if='selectedModule.asdSession' class="row row-center margin0 padding0">
		<div class="col padding0 nl-dlg-field-value">
			<select ng-model='selectedModule.reason' 
					ng-options='opt as opt.name for opt in options.reason track by opt.id'
					ng-change='changeSessionReason($event, selectedModule)'
					class='w100'
					autofocus=''
					tabindex=""
					style='min-height: 34px'>
			</select>
		</div>
		<div class="col col-67 padding0 padding-mid-left">
			<input type='text' placeholder='Mention remarks' ng-model='selectedModule.remarks'></input>
		</div>
	</div>
	
	<div class='padding-small'>
	</div>
	<table class='nl-table nl-table-styled3'>
		<tr class='header'>
            <td style='width: 50px;'>
            </td>
			<td style='width: 20%;'>
				<div>Learner Name</div> 
				<div>(Learner Id)</div>
			</td>
			<td style='width: 22%;'>
				Date
			</td>
			<td style='min-width: 150px;'>
				Attendance Status
			</td>
			<td style='min-width: 250px'>
				Remarks
			</td>
		</tr>
		<tr ng-repeat='report in selectedModule.learningRecords'
			ng-show='bulkMarker.showAttendance || !report.bulkEntry'
            class='{{report.bulkEntry ? "alternate" : report.lockedMessage ? "fgrey" : ""}}'>
            <td>
                <div class='nl-link-text fsh5' style='padding:10px' ng-if='bulkMarker.showAttendance && !report.bulkEntry && !report.lockedMessage'
					ng-click='report.selectedLr = !report.selectedLr'>
                    <i ng-show='report.selectedLr' class="icon ion-android-checkbox-outline black fsh6"></i>
                    <i ng-hide='report.selectedLr' class="icon ion-android-checkbox-outline-blank fsh6"></i>
                </div>
            </td>
			<td>
				<div>{{report.learnername}}</div>
				<div ng-if='!report.bulkEntry' class="fgrey">({{report.learnerid}})</div>
			</td>
			<td ng-if='!report.lockedMessage'>
				<div ng-show='report.attendance.id == "notapplicable"'>
					Date is not allowed for this learner.
				</div>
				<div ng-hide='report.attendance.id == "notapplicable"' style='border: {{report.bulkEntry ? "1px solid #ffffff" : ""}}; box-shadow: {{report.bulkEntry ? "2px 4px 5px 0 rgba(0,0,0,.06)" : ""}}'>
					<nl-date-select fieldmodelbyref='report.attMarkedOn'></nl-date-select>
				</div>
				<div ng-hide='report.attendance.id == "notapplicable"' class='row row-center padding0 margin0'>
					<div class='padding-small'>Shift: </div>
					<div class='nl-dlg-field-value'
						style='min-width:50px'>
						<select ng-model='report.shiftHrs' 
								ng-options='opt as opt.id for opt in options.shiftHrs track by opt.id'
								ng-change='changeSessionShiftTime($event, report)'
								class='w100'
								autofocus=''
								tabindex=""
								style='min-height: 34px'>
						</select>
					</div>
					<div class='padding-small'>:</div>
					<div class='nl-dlg-field-value'
						style='min-width:50px'>
						<select ng-model='report.shiftMins' 
								ng-options='opt as opt.id for opt in options.shiftMins track by opt.id'
								ng-change='changeSessionShiftTime($event, report)'
								class='w100'
								autofocus=''
								tabindex=""
								style='min-height: 34px'>
						</select>
					</div>
					<div class='padding-small'></div>
					<div class='padding-small'>-</div>
					<div class='padding-small'></div>
					<div class='nl-xxx-select nl-dlg-field-value padding-mid' style='min-width:60px;border: {{report.bulkEntry ? "1px solid #ffffff" : ""}}; box-shadow: {{report.bulkEntry ? "2px 4px 5px 0 rgba(0,0,0,.06)" : ""}}'>
						{{report.shiftEnd}}
					</div>
				</div>
			</td>
			<td class='nl-dlg-field-value'>
				<select ng-model='report.attendance' 
					ng-if='!report.lockedMessage'
					ng-options='opt as opt.name for opt in selectedModule.attendanceOptions track by opt.id'
					autofocus=''
					tabindex='0'>
				</select>
				<div ng-show='dontShowOptions[report.attendance.id]' class='fsmall1 nl-dlg-field-greyedmsg'>
					Marked as {{report.attendance.name}}
				</div>
				<div ng-if='report.bulkEntry && report.error' class='nl-dlg-field-errormsg'>
					{{report.error}}
				</div>
			</td>
			<td>
				<div ng-if='report.lockedMessage'
					 class='nl-dlg-field-value'>
					 {{report.lockedMessage}}
				</div>
				<div ng-if='!report.lockedMessage && selectedModule.attendanceRemarksOptions'
					 class='nl-dlg-field-value'>
					 <select ng-model='report.remarks' 
						ng-options='opt as opt.name for opt in selectedModule.attendanceRemarksOptions track by opt.id'
						autofocus=''
						tabindex='0'>
					</select>
				</div>
                <div ng-if='!report.lockedMessage && selectedModule.attendanceRemarksOptions && report.remarks.id == "Other"'
                     class='nl-dlg-field-value'>
                     <input ng-model='report.otherRemarks' 
                        type='text' 
                        autofocus=''
                        tabindex='0'
                        placeholder='Provide additional remarks'>
                </div>
				<div ng-if='!report.lockedMessage && !selectedModule.attendanceRemarksOptions'
					 class='nl-dlg-field-value'>
					 <input ng-model='report.remarks.id' 
						autofocus=''
						tabindex='0'
						placeholder='Provide remarks'>
				</div>
				<div ng-if='!report.lockedMessage && report.validationErrorMsg' class='nl-dlg-field-errormsg'>
					{{report.validationErrorMsg}}
				</div>
				<div ng-if='report.bulkEntry' class='row row-center padding-mid margin0'>
						<div class='col padding0'></div>
						<div class='nl-link-text nl-button-lowlight padding-small'
							 ng-click='hideBulkAttendanceMarker($event)'>Cancel</div>
						<div class='padding-small'></div>
						<div class='nl-link-text nl-button-highlight padding-small'
							 ng-click='bulkAttendanceMarker($event)'>Mark All</div>
						<div class='padding-small'></div>
						<div class='nl-link-text nl-button-highlight padding-small'
							 style='width:150px'
							 ng-click='markSelectedAttendance($event)'>Mark Selected</div>
				</div>
			</td>
		</tr>
	</table>
</div>
