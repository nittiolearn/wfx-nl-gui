<nl-dlg dlgTitle='Mark attendance' show-help='0'>
<nl-dlg-content>
<div class='row row-top row-stretch padding0 margin0 nl-85vh'>
	<div class='col nl-thin-scroll-mh100 padding0-right nl-max-250 nl-min-125'>
		<div class='padding-mid fsh4'>Sessions</div>
		<div ng-repeat='session in sessions track by $index'>
			<div class='nl-link-text 
			{{session.id == selectedSession.id ? "nl-left-tab-selected" : "nl-left-tab"}} padding-small
			{{session.asdSession ? "forange3" : ""}}'>
				<div class='padding-mid' 
					ng-click='onClick(session, $index)'
					style='position:relative'>
					{{session.asdSession ? session.reason.name : session.name}}
				</div>
			</div>
		</div>
	</div>
	<div class='col nl-left-tabbed-content nl-thin-scroll-mh100 nl-min-500' ng-show='selectedSession.canMarkAttendance'>
		<div class='row row-center padding-0 margin0'>
			<div class='col padding-mid fsh4' ng-if="!selectedSession.asdSession">Mark  the learner attendance for {{selectedSession.name}}</div>
			<div class='col padding-mid fsh4' ng-if="selectedSession.asdSession">{{selectedSession.reason.name || selectedSession.name}}</div>
			
			<div class='col nl-max-200 padding0 padding-mid-right'  ng-if='canShowDate'>
				<nl-date-select fieldmodelbyref='selectedSession.attendanceDate' fieldcls='padding0 padding-small-left'></nl-date-select>
			</div>
			<div class='nl-link-text nl-button-highlight' ng-click='bulkAttendanceMarker($event)'>Mark all</div>
		</div>
		<div class='row padding-mid margin0 margin-bottom-3' ng-if='canShowDate'>
			<div class='padding-small nl-link-text nl-button-highlight' 
				ng-click= 'onClickAddAsd(selectedSession)'>Add session
			</div>
			<div class="padding-small"></div>
			<div ng-if='selectedSession.sessionNo == 1' 
				 class='padding-small nl-link-text nl-button-highlight' 
				ng-click= 'onClickAddAsd(selectedSession, true)'>Add above
			</div>
			<div class="padding-small"></div>
			<div class='padding-small nl-link-text nl-button-highlight forange3' 
				ng-if='selectedSession.asdSession' 
				ng-click='onClickRemoveAsd(selectedSession)'
				style="background-color: #CCCCDD;">
				Remove session
			</div>
		</div>
			
		<div class="padding-mid margin0" ng-if='selectedSession.asdSession'>
			<div class="row row-center padding0 margin0">
				<div class="col padding0-x">Reason</div>
				<div class="col col-67 padding-mid-left">Remarks</div>
			</div>
			<div class="row row-center padding0 margin0">
				<div class="col padding0">
					<select ng-model='selectedSession.reason' 
							ng-options='opt as opt.name for opt in selectedSession.reasonOptions track by opt.id'
							class='w100'
							autofocus=''
							tabindex=""
							style='min-height: 34px'>
					</select>
				</div>
				<div class="col col-67 padding0 padding-mid-left">
					<input type='text' placeholder='Mention remarks' ng-model='selectedSession.remarks'></input>
				</div>
			</div>
		</div>
			
		<div class='row row-center padding0 margin0' ng-repeat='user in selectedSession["newAttendance"]'>
			<div class='row row-center padding0 margin0 {{(user.attrition || !user.canMarkLearner) ? "fgrey" : "row-wrap"}}'>
				<div ng-class='$root.respCol211' class='padding-mid'>
					<div class='row row-center padding0 margin0'>
						<div class='col padding0' >{{user.name}} <span class='fgrey'>({{user.userid}})</span></div>
						<div class='col padding0'>
							<select ng-model='user.attendance' 
									ng-if='!user.attrition && user.canMarkLearner'
									ng-options='opt as opt.name for opt in selectedSession.attendanceOptions track by opt.id'
									class='w100 '
									autofocus=''
									style='min-height: 34px'
									placeholder='"Write remarks"'>
							</select>
						</div>
					</div>
				</div>
				<div ng-class='$root.respCol211' class='padding-mid' ng-if='!user.remarkOptions && !user.attrition && user.canMarkLearner'>
					<input type='text' ng-model='user.remarks' placeholder='Mention remarks for learner'></input>
				</div>
				<div ng-class='$root.respCol211' class='padding-mid' ng-if='user.remarkOptions && !user.attrition && user.canMarkLearner'>
					<select ng-model='user.remarks' 
							ng-options='opt as opt.name for opt in user.remarkOptions track by opt.id'
							class='w100'
							autofocus=''
							tabindex="{{tabindex}}"
							style='min-height: 34px'>
					</select>
				</div>
				<div ng-if='user.attrition || !user.canMarkLearner' ng-class='$root.respCol211' class='padding-mid'>
					<span>{{user.attritionStr || user.disableMarkingStr}}</span>
				</div>
			</div>
		</div>
	</div>
	<div class='col nl-left-tabbed-content' ng-show='!selectedSession.canMarkAttendance'>
		<div class='padding-mid' style='line-height: 175%'>
			You cannot mark attendance unless milestone <b>{{selectedSession.error}}</b> is marked as reached.
		</div>
	</div>
</div>
</nl-dlg-content>
</nl-dlg>