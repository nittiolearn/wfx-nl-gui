<nl-dlg dlgTitle='{{dlgTitle}}' show-close='1' show-help='0'>
<nl-dlg-content>
<div class='row row-top row-stretch padding0 margin0 nl-85vh' style='min-width: 600px;'>
	<div style='width: 25%; min-width: 100px; border-right: 1px solid rgba(0, 0, 0, 0.1)'
		 class='nl-thin-scroll-mh100'>
		<div>
		    <div ng-repeat='cm in modules' class='row row-center margin0' ng-show='cm.visible' style='padding: 8px'>
		        <div style='width: {{cm.indentationLevel*16}}px'></div>
		        <div class='row row-center margin0 padding-mid nl-cv-item-on-dlg nl-link-text {{selectedModule.id == cm.id ? "selected" : ""}}'
		             ng-click='onClick($event, cm)'>
		            <div ng-show='cm.type == "module"' style='width: 20px'>
		                <i ng-show='!cm.isOpen' class="icon ion-arrow-right-b bold fsh3"></i>
		                <i ng-show='cm.isOpen' class="icon ion-arrow-down-b bold fsh3"></i>
		            </div>
		            <div class='col nl-cv-item-text {{cm.asdSession ? "forange3" : ""}}'>{{cm.name}}</div>
		         </div>
		    </div>
		</div>
	</div>
	<div ng-if='!selectedModule' class='fsh5 padding-mid'>
		Please select the course element to view the status.
	</div>
	<div ng-if='selectedModule' class='col margin0 padding0 nl-thin-scroll-mh100'>
		<div ng-if='chartInfo'>
			<div class='row row-center margin0 padding0'>
				<div class='col padding-mid'>
					<div style='margin: auto; display: block; width: 150px; height: 150px'>
						<canvas class='chart chart-doughnut'
								style='height:150px; width:150px'
								chart-data='chartInfo.data'
								chart-labels='chartInfo.labels'
								chart-colors='chartInfo.colours'
								chart-options='chartInfo.options'>
						</canvas> 
					</div>
				</div>
				<div class='col padding-mid'>
					<table class='nl-table nl-table-styled3 rowlines'>
						<tr ng-repeat='item in chartData'>
							<td>{{item.name}}</td>
							<td>{{item.val}}</td>
						</tr>
						<tr class='header'>
							<td>Total</td>
							<td>{{chartTotal}}</td>
						</tr>
					</table>
				</div>
			</div>
			<div class='nl-border-bottom'></div>
			<div class='padding-mid'></div>
		</div>
	
		<div ng-if='selectedModule.type == "module"' class='fsh5 padding-mid'>
			Folder:  {{selectedModule.name}}
		</div>

		<div ng-if='selectedModule.type == "lesson"'>
		<div class='padding-mid'>
			<div class="row row-center margin0 padding-mid">
				<div class='col padding-mid fsh5'>{{selectedModule.name}}</div>
				<div class="nl-link-text nl-button-highlight" style='padding-top: 0px'>
					<a ng-href='{{getUrl(selectedModule.refid)}}'
						target='_blank'
						class='row row-center margin0 padding0'>
						<span class="col text-center">View Module</span>
					</a>
				</div>
				<span class='padding-small'></span>
				<div class="nl-link-text nl-button-highlight" style='padding-top: 0px'
					ng-click='viewDetailedReport(selectedModule)'>
					<span class="row row-center margin0">
						View detailed report
					</span>
				</div>
			</div>
		</div>
		<div class='nl-border-bottom'></div>
		<div class='padding-mid'></div>
		</div>

		<div ng-if='selectedModule.type == "iltsession"'>
			<div class='padding-mid'>
				<div class="row row-center margin0 padding-mid" ng-if='selectedModule.url'>
					<div class='col padding-mid fsh5'></div>
					<div class="nl-link-text nl-button-highlight" ng-click='launchMeeting(selectedModule)'>
						<div style='padding:0 15px'>Start meeting</div>
					</div>
				</div>
				<span class='fbold'>Session duration: </span><span> {{selectedModule.iltduration}} (minutes)</span>
				<div ng-show='selectedModule.trainer_notes.length > 0'>
					<div class="padding-mid"></div>
					<div class="fbold">Trainer notes:</div>
					<div ng-repeat='notes in selectedModule.trainer_notes' 
						class='row row-center padding-mid margin0'>
						<div class='col padding-mid'>{{notes.name}}</div>
						<div class="nl-link-text nl-button-highlight" style='padding-top: 0px'>
							<a ng-href='{{getUrl(notes.id)}}'
								target='_blank'
								class='row row-center margin0 padding0'>
								<span class="col text-center">View</span>
							</a>
						</div>
					</div>
				</div>
			</div>
			<div class='nl-border-bottom'></div>
			<div class='padding-mid'></div>
		</div>

		<div ng-if='selectedModule.type == "milestone"'>
			<div class='padding-mid'>
				<div ng-if='!selectedModule.milestoneObj.status' class='padding-mid fsh6'>
					Milestone is not reached.
				</div>
				<div ng-if='selectedModule.milestoneObj.status'
					class='padding-mid fsh6'>
					Milestone achieved.</b>
				</div>
				<div ng-if='selectedModule.milestoneObj.status' class='padding-mid'> <span><b> Milestone remark: </b></span> <span>{{selectedModule.milestoneObj.comment}}</span></div>
			</div>
			<div class='nl-border-bottom'></div>
			<div class='padding-mid'></div>
		</div>

		<div ng-if='totalUserCount > 0'>
			<div class='row row-center margin0 padding-mid'>
				<input ng-model='search.searchStr'
					   ng-keydown='onSearchKey($event)'
					   class='col padding-mid'
					   placeholder='Search user or status and press enter'>
				<div class='padding-mid'>
					<div class="nl-link-text nl-button-highlight" style='padding-top: 0px'
						 ng-click='onSearch($event)'>
						<span class="col text-center">Search</span>
					</div>
				</div>
			</div>
			<div class='padding-mid fgrey fsmall1'>
				Showing {{visibleUsers.length}} of {{chartTotal}} items.
			</div>
		</div>

		<div ng-if='visibleUsers.length > 0' class='padding-mid'>
			<table class='nl-table nl-table-styled3 rowlines'>
				<tr class='header'>
					<td>
						Learner Name
					</td>
					<td>
						Learner Id
					</td>
					<td>
						Status
					</td>
					<th ng-if='selectedModule.showScore'>
						Score
					</td>
					<th ng-if='selectedModule.showRemarks'>
						Remarks
					</td>
				</tr>
				<tr ng-repeat='user in visibleUsers track by $index'>
					<td>
						{{user.name}}
					</td>
					<td>
						{{user.id}}
					</td>
					<td>
						{{user.statusStr}} {{user.statusStr2 ? 'on '+user.statusStr2 : ''}}
					</td>
					<td ng-if='selectedModule.showScore'>
						{{user.score || '-'}} {{user.score ? '%' : ''}}
					</td>
					<td ng-if='selectedModule.showRemarks'>
						{{user.remarks || ''}}
					</td>
				</tr>

			</table>
		</div>
	</div>
</div>
</nl-dlg-content>
</nl-dlg>
