<style>
    .minbgimg {
    	min-height: 90vh;
        width: 100%;
    }
    .content {
        position: absolute;
        top: 45%;
        left: 10%;
        width: 80%;
        height: 35%;
        overflow: hidden;
        font-family: Times New Roman, Verdana, Helvetica, Arial, sans-serif;
        text-align: center;
    }

    .nl-screen-small .content {
        font-size: 90%;
    }

    .nl-screen-medium .content {
        font-size: 120%;
    }
    .fmtuser {
        font-style: italic;
        font-weight: 900;
        font-size: 130%;
    }
    
    .sample {
    	color: red;
    }
</style>
<nl-dlg dlgTitle='{{dlgTitle}}' show-close='1' show-help='0'>
<nl-dlg-content>
<div class='row row-top row-wrap row-stretch padding0 margin0'>
	<div style='width:{{screenSize == "small" ? "100": "25"}}%; border-right: 1px solid rgba(0, 0, 0, 0.1)'>
		<div class='nl-thin-scroll'>
		    <div ng-repeat='cm in modules' class='row row-center margin0' ng-show='cm.visible' style='padding: 8px'>
		        <div style='width: {{cm.indentationLevel*16}}px'></div>
		        <div class='row row-center margin0 padding-mid nl-cv-item nl-link-text {{selectedSession.id == cm.id ? "selected" : ""}}'
		             ng-click='onClick($event, cm)'>
		            <div ng-show='cm.type == "module"' style='width: 20px'>
		                <i ng-show='!cm.isOpen' class="icon ion-arrow-right-b bold fsh3"></i>
		                <i ng-show='cm.isOpen' class="icon ion-arrow-down-b bold fsh3"></i>
		            </div>
		            <div class='col'>{{cm.name}}</div>
		         </div>
		    </div>
		</div>
	</div>
	<div ng-if='!selectedSession' class='fsh5 padding-mid'>
		Please select the course element to view the status.
	</div>
	<div class='col margin0 padding0'  ng-if='selectedSession'>
		<div class='row row-center margin0 padding0 nl-border-bottom'>
			<div ng-if='!(selectedSession.type == "module" || selectedSession.type == "certificate")' ng-class='respCol221'
				class='padding' style='text-align: -webkit-center;'>
				<div style='width: 150px; height: 150px'>
					<canvas class='chart chart-doughnut'
							style='height:150px; width:150px'
							chart-data='chartInfo.data'
							chart-labels='chartInfo.labels'
							chart-colours='chartInfo.colours'>
					</canvas> 
				</div>
			</div>
			<div ng-class='respCol221'>
				<div class='padding-mid' ng-hide='selectedSession.type == "module" ||  selectedSession.type == "certificate"'>
					<table class='nl-table'>
						<tr ng-repeat='item in allowedAttrs' ng-if='selectedSession[item.attr].length > 0'>
							<td class='nl-border' ng-show='item.type == "string"'>{{item.title}}</td>
							<td class='nl-border' colspan='1' ng-show='item.type == "string"' style='text-align: right'>{{selectedSession[item.attr].length || '-'}}</td>
						</tr>
						<tr>
							<td class='nl-border'><b>Total</b></td>
							<td class='nl-border' colspan='1' style='text-align: right'>
								<b>{{selectedSession.total || '-'}}</b>
							</td>
						</tr>
					</table>
				</div>
			</div>
		</div>
		<div ng-if='selectedSession.type == "lesson"' class="padding-mid">
			<a ng-href='{{getUrl(selectedSession.refid)}}'
				target='_blank'
				class='nl-link-text nl-button-highlight padding-mid'>
				<span class="col text-center">View Module Content</span>
			</a>
		</div>
		<div ng-show='selectedSession.type == "iltsession"' class="padding-mid ng-binding">
			<span class='fbold'>Session duration:</span><span>{{selectedSession.iltduration}} (minutes)</span>
		</div>
		<div ng-show='selectedSession.text' class='row row-center padding-mid'>		
			<div class='padding-mid'>
				<div nl-compile='selectedSession.textHtml' class='nl-content-holder'></div>
			</div>
		</div>		
		<div ng-show='selectedSession.trainer_notes.length > 0'>
			<div class="padding-mid ng-binding fbold">Trainer notes:</div>
			<div ng-repeat='notes in selectedSession.trainer_notes' 
				class='row row-center padding-mid margin0 nl-border'>
				<div class='col'> {{notes.name}}</div>
				<div class="nl-link-text nl-button-highlight" style='padding-top: 0px'>
					<a ng-href='{{getUrl(notes.id)}}'
						target='_blank'
						class='row row-center margin0 padding0'>
						<span class="col text-center">View</span>
					</a>
				</div>
			</div>
		</div>
		<div ng-if='selectedSession.type == "certificate"'
			style='position: relative;'>
			<div ng-if='!selectedSession.certificate_image' class='minbgimg'></div>
			<img ng-if='selectedSession.certificate_image' class='minbgimg' ng-src='{{selectedSession.certificate_image}}'>
			<div class='content'>
				<p class='fmttitle'>This is to certify that</p>
				<p class='fmtuser {{sample ? "sample": ""}}'>user name</p>
				<p class='fmttext'>
				has successfully completed the online training module on
				</p>
				<p style='font-weight: 900'>{{dlgTitle}}</p>
				<p>
				on <span class='fmtdate {{sample ? "sample": ""}}'>{{ss | date : 'dd-MMMM-yyyy'}}</span>.
				</p>
			</div>
		</div>
		<div class='row row-center padding-mid margin0 fsh6'>
			Detailed learner status:
		</div>
		<div class='margin0 padding-mid' ng-if='selectedSession.type == "milestone"'>
			<div ng-if='selectedSession.itemDict.milestoneObj.status'>
				<div class='padding-mid fsh6'>The milestone is marked as reached at <b>{{selectedSession.itemDict.milestoneObj.reached}}</b></div>
				<div class='padding-mid'> <span><b> Milestone remark: </b></span> <span>{{selectedSession.itemDict.milestoneObj.comment}}</span></div>
				<mark-milestone-tab selecteditem='selectedSession.itemDict' readonly='true' class='w100'></mark-milestone-tab>
			</div>
			<div ng-if='!selectedSession.itemDict.milestoneObj.status' class='fsh6'>
				Milestone is not marked as achieved.
			</div>
		</div>
		<div class='padding-mid' ng-if='selectedSession.type == "rating"'>
			<mark-rating-tab selecteditem='selectedSession.itemDict' readonly='true' class='w100'></mark-rating-tab>
		</div>
		<div class='padding-mid' ng-if='selectedSession.type == "iltsession"'>
			<mark-attendance-tab selecteditem='selectedSession.itemDict' readonly='true' class='w100'></mark-attendance-tab>
		</div>
		<div class='padding-mid' ng-if='selectedSession.type == "lesson" || selectedSession.type == "info" 
				|| selectedSession.type == "link" || selectedSession.type == "gate" || selectedSession.type == "certificate"'>
			<div ng-repeat='user in selectedSession.itemDict' 
				class='row padding0 margin0 row-wrap'>
				<div ng-class='respCol221' class='padding-mid'>
					<div class='row row-center padding0 margin0'>
						<div class='col' >{{user.name}} <span class='fgrey'>({{user.userid}})</span></div>
					</div>
				</div>
				<div ng-if='selectedSession.type == "lesson" || selectedSession.type == "gate"' ng-class='respCol221' class='padding-mid'>
					<div class='row row-center padding0 margin0'>
						<div class='col' >{{user.status}}</div>
						<div class='col' >{{user.score}}</div>
					</div>
				</div>
				<div ng-if='selectedSession.type == "info" || selectedSession.type == "link" || selectedSession.type == "certificate"' ng-class='respCol221' class='padding-mid'>
					<div class='row row-center padding0 margin0'>
						<div class='col' >{{user.status}}</div>
						<div class='col' >{{user.remarks}}</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
</nl-dlg-content>
</nl-dlg>
<!---
				<div class='nl-link-text' ng-repeat='state in allowedAttrs' ng-if='selectedSession[state.attr] && selectedSession[state.attr].length > 0' 
					ng-click='state.canShow = !state.canShow' style='border: 1px solid #FFFFFF'>
					<div class='row row-center margin0 fsh5 padding-mid' style='background: #CCCCDD'>
						<div class='col'>{{state.title}}</div>
						<span>{{selectedSession[state.attr].length}}</span>
					</div>
					<div class='row row-center margin0' 
						 ng-repeat='user in selectedSession[state.attr]' ng-show='state.canShow'>
						<div class='col padding-mid'>{{user.name}}</div>
					</div>
				</div>
-->